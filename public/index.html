<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tech Support Bro</title>
    <link rel="stylesheet" href="./styles.css">
    <style>
        /* Force-hide floating badges and tablet logo on small screens */
        .floating-badges { display: none !important; }
        .tablet-screen-logo { display: none !important; visibility: hidden !important; opacity: 0 !important; }
        @media (min-width: 1025px) {
            .floating-badges { display: flex !important; }
        }
    </style>
</head>
<body>
    <main class="layout">
        <section class="hero hero-shell">
            <div class="hero-content">
                <img src="./techsupportbrologo.png" alt="Tech Support Bro" class="hero-logo">
                <div class="hero-actions">
                    <button id="startTree" class="primary">Start troubleshooting</button>
                    <a class="secondary" href="https://docs.google.com/forms/d/e/1FAIpQLSfoxhKvog1UU0YnpnK1U1toIyQkNborx3IAVtJOpc-5VwKhAg/viewform?usp=dialog" target="_blank" rel="noopener">
                        Escalate to 'G'
                    </a>
                </div>
            </div>
            <div class="hero-visual">
                <div class="grid-lines"></div>
                <div class="tablet-stage" id="tabletStage">
                    <div class="tablet-shadow"></div>
                    <div class="tablet" id="tabletModel">
                        <div class="tablet-face"></div>
                        <div class="tablet-back">
                            <img class="tablet-back-logo" draggable="false" src="./techsupportbrologo.png" alt="Tech Support Bro logo">
                        </div>
                        <div class="tablet-screen">
                            <video autoplay muted loop playsinline style="pointer-events: none;">
                                <source src="./ITChatBuddyAvatar.mp4" type="video/mp4">
                                <source src="./ITChatBuddyAvatar.mov" type="video/quicktime">
                                Your browser does not support inline video playback.
                            </video>
                            <h2 class="tablet-title">Tech Support Bro</h2>
                            <span class="tablet-caption">"What can I fix for you today?"</span>
                            <div class="tablet-screen-indicator"></div>
                        </div>
                    </div>
                    <div class="floating-badges">
                        <div class="floating-badge">Fix my home Wi-Fi</div>
                        <div class="floating-badge">Speed up my laptop</div>
                        <div class="floating-badge">Reset forgotten passwords</div>
                    </div>
                    <div class="tablet-interactive-hint">Tap or click the tablet to interact</div>
                </div>
            </div>
        </section>

        <section class="tree-card">
            <div class="tree-header">
                <div>
                    <p class="node-path">Start here</p>
                    <h2>How this tool works</h2>
                    <p class="node-summary">Pick your category, follow the branching steps, and use Back or Start over anytime.</p>
                </div>
            </div>
            <div class="node-body">
                <div class="node-response">
                    <strong>What to expect:</strong> choose a device/issue, get clear step-by-step actions with official links, and switch paths easily. Nothing is stored or sent—everything runs in your browser.
                </div>
            </div>
        </section>

        <section class="tree-card" id="treePanel">
            <div class="tree-header">
                <div>
                    <p class="node-path" id="nodePath">Start</p>
                    <h2 id="nodeTitle">Choose a Help Topic</h2>
                    <p class="node-summary" id="nodeSummary">Click "Start troubleshooting" to load the root of the decision tree.</p>
                </div>
                <div class="tree-controls">
                    <button class="ghost" id="backBtn" disabled>Back</button>
                    <button class="ghost" id="restartBtn" disabled>Start over</button>
                    <button class="ghost" id="copyPlanBtn" disabled>Copy plan</button>
                </div>
            </div>
            <div class="node-body">
                <div class="node-response" id="nodeResponse">
                    The offline instructions will appear here after you pick a branch.
                </div>
                <div class="node-tags" id="nodeTags"></div>
                <div class="node-links" id="nodeLinks"></div>
                <div class="node-children" id="nodeChildren"></div>
            </div>
        </section>

        <section class="vibe-section" id="affirmationExperience">
            <div class="vibe-copy">
                <p class="eyebrow">Mental reset</p>
                <h2>Virtual phone affirmations</h2>
                <p>
                    Sometimes the fix is to pause for sixty seconds and hear a kind voice. Scroll into this lab to
                    spin, tap, and read positive prompts before diving back into tough tickets.
                </p>
                <ul class="vibe-list">
                    <li>Live loop of encouraging affirmations curated for late-night tech support sessions.</li>
                    <li>Interactive 3D-inspired phone shell that reacts to your pointer drags.</li>
                    <li>Quick action button cycles to the next vibe whenever you need another boost.</li>
                </ul>
                <div class="vibe-actions">
                    <button type="button" class="ghost" id="affirmationNext">Inspire me again</button>
                    <span class="vibe-caption">Gently scroll past the troubleshooting menus to reach this tool anytime.</span>
                </div>
            </div>
            <div class="vibe-phone-column">
                <div class="vibe-phone-glow"></div>
                <div class="vibe-phone-stage" data-role="affirmation-stage">
                    <div class="vibe-phone-rig" data-role="affirmation-rig">
                        <div class="vibe-phone-shell">
                            <span class="phone-signal"></span>
                            <div class="vibe-phone-screen" id="affirmationScreen">
                                <span class="screen-inner-shadow" aria-hidden="true"></span>
                                <span class="screen-reflection" aria-hidden="true"></span>
                                <div class="screen-status">
                                <span id="affirmationTime">11:11</span>
                                <span class="signal-indicator" aria-label="Signal strength">
                                    <span class="signal-bar bar-1"></span>
                                    <span class="signal-bar bar-2"></span>
                                    <span class="signal-bar bar-3"></span>
                                    <span class="signal-bar bar-4"></span>
                                </span>
                            </div>
                                <div class="affirmation-tag speech-bubble bubble-tag bubble-layer-2" id="affirmationTag">Grounding</div>
                                <blockquote class="speech-bubble bubble-message bubble-layer-3" id="affirmationText">Your calm is contagious.</blockquote>
                                <p class="affirmation-meta speech-bubble bubble-meta bubble-layer-2" id="affirmationSource">- Message from 'G'</p>
                                <div class="affirmation-ticker bubble-ticker" id="affirmationTicker"></div>
                            </div>
                            <div class="phone-notch">
                                <span class="notch-speaker"></span>
                                <span class="notch-camera"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="privacy-note">
            Privacy: We don't collect personal data. This tool runs locally in your browser; no analytics or telemetry are sent.
        </section>

    </main>
    <script src="./app.js"></script>
    <script>
        (() => {
            const stage = document.querySelector('[data-role="affirmation-stage"]');
            const rig = stage?.querySelector('[data-role="affirmation-rig"]');
            const screen = document.getElementById('affirmationScreen');
            const nextBtn = document.getElementById('affirmationNext');
            const timeEl = document.getElementById('affirmationTime');
            const textEl = document.getElementById('affirmationText');
            const tagEl = document.getElementById('affirmationTag');
            const sourceEl = document.getElementById('affirmationSource');
            const tickerEl = document.getElementById('affirmationTicker');

            if (!stage || !rig || !screen) {
                return;
            }

            const isTickerTarget = (event) => {
                if (!tickerEl) {
                    return false;
                }
                if (tickerEl.contains(event.target)) {
                    return true;
                }
                const rect = tickerEl.getBoundingClientRect();
                const buffer = Math.min(6, rect.height * 0.25);
                return event.clientY >= rect.top - buffer && event.clientY <= rect.bottom + buffer;
            };

            const affirmations = [
                {
                    text: 'Your calm presence is a diagnostic tool - breathe and let the next step appear.',
                    tag: 'Grounding',
                    source: "- Message from 'G'"
                },
                {
                    text: 'You have navigated harder days. Trust the resilience you already built.',
                    tag: 'Confidence',
                    source: "- Message from 'G'"
                },
                {
                    text: 'Lead with curiosity, not perfection. Ask the question that unlocks momentum.',
                    tag: 'Leadership',
                    source: "- Message from 'G'"
                },
                {
                    text: 'Unclench your jaw. Breathe into the space you just made.',
                    tag: 'Release',
                    source: "- Message from 'G'"
                },
                {
                    text: 'Hydrate, stretch, then reset your focus. Your mind needs its own buffer.',
                    tag: 'Reset',
                    source: "- Message from 'G'"
                },
                {
                    text: 'Joy is contagious. Share one tiny win before you close your notebook.',
                    tag: 'Connection',
                    source: "- Message from 'G'"
                },
                {
                    text: 'You are allowed to pause. You are allowed to ask for help.',
                    tag: 'Support',
                    source: "- Message from 'G'"
                },
                {
                    text: 'Focus on the next small, true thing you can verify.',
                    tag: 'Focus',
                    source: "- Message from 'G'"
                }
            ];

            const ticks = [
                ' hydrate ',
                ' stretch ',
                ' blink ',
                ' check posture ',
                ' breathe ',
                ' walk 30 seconds '
            ];

            let isDragging = false;
            let startX = 0;
            let startY = 0;
            let currentX = 0;
            let currentY = 0;

            const setCSSVar = (key, value) => {
                rig?.style.setProperty(key, value);
            };

            const updateTime = () => {
                const now = new Date();
                const hours = now.getHours().toString().padStart(2, '0');
                const minutes = now.getMinutes().toString().padStart(2, '0');
                if (timeEl) timeEl.textContent = `${hours}:${minutes}`;
            };

            const pickRandom = (items) => items[Math.floor(Math.random() * items.length)];

            const renderAffirmation = () => {
                const next = pickRandom(affirmations);
                if (textEl) textEl.textContent = next.text;
                if (tagEl) tagEl.textContent = next.tag;
                if (sourceEl) sourceEl.textContent = next.source;
            };

            const buildTicker = () => {
                if (!tickerEl) return;
                tickerEl.innerHTML = '';
                const content = Array.from({ length: 12 }).map(() => pickRandom(ticks)).join(' • ');
                tickerEl.textContent = content;
            };

            const startCycle = () => {
                renderAffirmation();
                setInterval(renderAffirmation, 8000);
            };

            const applyTransform = () => {
                const dampen = 26;
                const x = currentX / dampen;
                const y = currentY / dampen;
                const maxTilt = 10;
                const tiltX = Math.max(-maxTilt, Math.min(maxTilt, y));
                const tiltY = Math.max(-maxTilt, Math.min(maxTilt, -x));
                rig?.style.setProperty('--tilt-x', `${tiltX}deg`);
                rig?.style.setProperty('--tilt-y', `${tiltY}deg`);
                rig?.style.setProperty('--tilt-amount', `${Math.max(Math.abs(tiltX), Math.abs(tiltY))}deg`);
                rig?.style.setProperty('--cursor-x', `${x * 1.25}px`);
                rig?.style.setProperty('--cursor-y', `${y * 1.25}px`);
                rig?.style.setProperty('--mirror-shift-x', `${x * -1.5}px`);
                rig?.style.setProperty('--mirror-shift-y', `${y * 1.5}px`);
            };

            const queueDrift = () => {
                setCSSVar('--tilt-x', '4deg');
                setCSSVar('--tilt-y', '-6deg');
                setCSSVar('--cursor-x', '0px');
                setCSSVar('--cursor-y', '0px');
                setCSSVar('--mirror-shift-x', '0px');
                setCSSVar('--mirror-shift-y', '0px');
            };

            const handlePointerDown = (event) => {
                isDragging = true;
                startX = event.clientX;
                startY = event.clientY;
            };

            const handlePointerMove = (event) => {
                if (!isDragging) return;
                const dx = event.clientX - startX;
                const dy = event.clientY - startY;
                currentX = dx;
                currentY = dy;
                applyTransform();
            };

            const handlePointerUp = () => {
                isDragging = false;
                currentX = 0;
                currentY = 0;
                applyTransform();
                queueDrift();
            };

            stage.addEventListener('pointerdown', handlePointerDown);
            stage.addEventListener('pointermove', handlePointerMove);
            stage.addEventListener('pointerup', handlePointerUp);
            stage.addEventListener('pointerleave', handlePointerUp);

            // Prevent context menu on right-click
            stage.addEventListener('contextmenu', (event) => {
                event.preventDefault();
            });

            screen.addEventListener('pointerdown', (event) => {
                const rect = screen.getBoundingClientRect();
                const ripple = document.createElement('span');
                ripple.className = 'screen-ripple';
                ripple.style.left = `${((event.clientX - rect.left) / rect.width) * 100}%`;
                ripple.style.top = `${((event.clientY - rect.top) / rect.height) * 100}%`;
                screen.appendChild(ripple);
                ripple.addEventListener('animationend', () => ripple.remove());
            });

            nextBtn?.addEventListener('click', renderAffirmation);
            const blockTickerPointer = (event) => {
                event.stopPropagation();
                event.preventDefault();
            };
            ['pointerdown', 'pointermove', 'pointerup', 'pointercancel', 'click'].forEach((type) => {
                tickerEl?.addEventListener(type, blockTickerPointer, true);
            });

            renderAffirmation();
            buildTicker();
            updateTime();
            setInterval(updateTime, 15000);
        })();
    </script>
</body>
</html>
